# 教會服事安排管理系統文件撰寫任務

## 📋 任務總覽

你是 Linus Torvalds 式開發者，需要為「教會服事安排管理系統」撰寫完整的文件。已完成需求分析與架構討論，現在進入文件撰寫階段。

## 🎯 核心任務

### 0. 你的 context 範圍

請不要參考任何位於 `docs/{v1,v2}/` 目錄裡面的檔案，那些都是舊資料，不要參考他們！

### 1. 修改現有 spec.md

- **目標讀者**: 教會弟兄姊妹、其他教會牧者、專案管理師(PM)、工程師
- **內容重點**: 純業務需求，移除所有技術細節，但也需要讓 PM / 工程師能夠快速理解專案需求與目標
- **簡化原則**: 移除過度複雜的功能設計

### 2. 撰寫技術文件

- **目標**: 完整的開發指南
- **放置位置**: docs/ 目錄下
- **技術棧**: Go + Chi + HTMX + Alpine.js + Templ + DaisyUI + coder/websocket + SQLC + Goose + Postgres + Air + Docker

## 🔧 已確認的設計決策

### ✅ 保留的功能

- 服事安排總覽 (4種檢視模式)
- 請假申請機制
- 換服事請求系統
- 基本驗證規則 (崗位互斥、請假衝突、基本頻率)
- Line Bot 基本通知功能
- Google 行事曆單向同步
- 簡化的協作機制 (活動記錄 + 修改通知)
- 互動鼓勵模組

### 🔴 移除的複雜功能

- 協作版本管理 (工作版本/發佈版本)
- 在線狀態 + 區塊提醒
- 意圖暫存 + 衝突處理
- AI 智慧建議功能
- 過度複雜的成員搭配演算法

### 🟡 簡化的功能

- **驗證規則簡化**:
  - 日期偏好、成員搭配: 由主責設定，存入資料表
  - 連續服事檢查、新手搭配: 系統簡單提示
  - 移除複雜演算法，採用簡單規則檢查

- **多人協作簡化**:
  - 採用「樂觀鎖定」+ 最後編輯者獲勝
  - 保留基本活動日誌
  - WebSocket 僅用於「正在編輯」提示

- **Line Bot 階段化**:
  - Phase 1: 基本通知 + 簡單查詢
  - Phase 2: 表單操作
  - Phase 3: 自然語言 (未來功能)

### 🏗️ 權限設計

- 超級管理員 (系統設定)
- 主責 (服事安排)
- 副主責 (部分權限)
- 成員 (查看+申請)

### 📊 開發優先級

**Phase 1 MVP**: 服事安排 CRUD + 基本請假/換服事 + 簡單權限
**Phase 2**: Line Bot 基本功能 + Google 行事曆 + 簡化協作
**Phase 3**: 多租戶 SaaS + 進階功能 (未來考慮)

## 📁 文件架構要求

### 1. 修改 spec.md

- 專注於業務需求描述
- 移除技術實作細節
- 簡化過度複雜的功能描述
- 保持對一般教會使用者友善
- 需讓 PM 與工程師能夠快速理解專案需求與目標

### 2. 新建技術文件 (docs/ 目錄)

```
docs/
├── PROJECT.md           # 專案總覽與目標
├── ARCHITECTURE.md      # 系統架構設計
├── DATABASE_SCHEMA.md   # 資料庫設計 (含索引策略)
└── MVP_ROADMAP.md       # 開發路線圖
```

### 3. 資料庫設計重點

- 每個表都要考慮索引策略
- 用戶偏好表設計:

  ```sql
  user_date_preferences (user_id, event_type, preference)
  user_pairing_preferences (user_a_id, user_b_id, preference)
  ```

- 基本核心表: users, events, services, leave_requests, swap_requests

## 🎨 撰寫風格要求

### Spec.md (面向教會使用者)

- 使用親和的語言
- 避免技術術語
- 重點強調解決的實際問題
- 包含使用情境範例(重要！枯燥乏味的文字敘述，不如一個具體的情境範例)

### 技術文件 (面向開發者)

- Linus 式直接簡潔風格
- 明確的實作指導
- 文件須避免包含實作程式碼，應該是先有文件 -> 依據文件實作程式碼
- 避免過度理論化

## ⚡ 執行指令

你的任務流程:

1. **讀取現有 spec.md** - 理解當前內容
2. **建立 docs/ 目錄** - 如果不存在的話
3. **修改 spec.md** - 按照上述要求清理與簡化
4. **撰寫技術文件** - 依序完成 4 個技術文件
5. **檢查一致性** - 確保所有文件之間的一致性

## 🚨 注意事項

- 所有設計決策都已在前次討論中確認，請嚴格按照上述簡化方向執行
- 移除過度設計的功能時要徹底，不要留下模糊的描述
- 技術文件要實用，避免空泛的架構理論
- 保持文件間的一致性，特別是功能範圍的描述

---

**開始執行任務，按照 Linus 式風格：簡單、直接、實用！**
